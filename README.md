# Long reads shotgun metagenomics of rice straw decomposition

This repository contains the scripts and workflows used to benchmark **MetaWGS**, **HiFi-MAG-Pipeline**, **LorBin**, and **SemiBin2** for contig-level binning of long-read metagenomic assemblies derived from PacBio HiFi datasets.

The study compares the performance of the four pipelines/binners in terms of genome completeness, contamination, and overall MAG quality. Quality assessment and benchmarking were performed using **MAGFlow**.

---

## Repository Contents

This repository includes:

- Scripts to run **LorBin** and **SemiBin2** on metagenomic assemblies  
- Workflow scripts for executing **MetaWGS**, **HiFi-MAG**, and **MAGFlow**  
- R scripts used for statistical analysis and figure generation  
- Processed output tables generated by MAGFlow for different sample types  
- Selected figures used in the final report  

```
project/
│
├── Assembly/
│   ├── fastqc/
│   ├── hifiasm-meta/
│   │   ├── assembly_metrics/
│   │   ├── assembly_metrics_primary/
│   │   └── multiqc_report/
│   │
│   ├── metaflye/
│   │   ├── assembly_metrics/
│   │   ├── assembly_metrics_primary/
│   │   └── multiqc_report/
│   │
│   ├── comparison_plots/
│   └── software_versions/
│
├── Binning/
│   ├── metagWGS/
│   ├── samples/
│   │   ├── new_no_treatment/
│   │   ├── new_treatment/
│   │   ├── old_no_treatment/
│   │   └── old_treatment/
│
├── scripts/
│   ├── R/
│   └── bash/
│
└── README.md
```

### Assembly

Contains quality control, assembly outputs, and assembly comparison results for hifiasm-meta and metaFlye.

- `fastqc/` – Quality control reports for raw reads  
- `hifiasm-meta/` – Assembly outputs and metrics  
- `metaflye/` – Assembly outputs and metrics  
- `comparison_plots/` – Assembly comparison visualizations  
- `software_versions/` – Software versions used for MetaWGS  

### Binning

Contains binning results and quality assessment for different pipelines and sample types.

- `metagWGS/` – Outputs and plots generated by the MetaWGS pipeline  
- `samples/` – Binning results grouped by sample type:
  - `new_no_treatment/`
  - `new_treatment/`
  - `old_no_treatment/`
  - `old_treatment/`

### Scripts

Contains all analysis scripts used in this project.

- `R/` – Statistical analyses and plotting scripts  
- `bash/` – Workflow and execution scripts  

---

## Dataset Information

All analyses were performed on PacBio HiFi long-read shotgun metagenomic datasets obtained from rice straw decomposition samples.

## Tools and Software

### MetaWGS Pipeline (v2.5.0)  
Repository: [MetaWGS](https://forge.inrae.fr/genotoul-bioinfo/metagwgs)

- Nextflow v22.04.0  
- Python v3.10.8  
- FastQC v0.12.1  
- Hifiasm v0.13-r308  
- Quast v5.3.0  
- Minimap2 v2.24-r1122  
- Samtools v1.15.1  
- Concoct v1.1.0  
- MetaBAT2 v2.18  
- MaxBin v2.2.7  
- Binette v1.1.2  
- dRep v3.5.0  
- GTDB-Tk v2.4.0  
- tRNAscan-SE v2.0.11  
- Barrnap v0.9  
- Prodigal v2.6.3  

---

### LorBin (v0.1.0)  
Repository: [LorBin](https://github.com/LorMeBioAI/LorBin)

- Anaconda3 v2022.05  
- Minimap2 v2.20 (GCCcore-10.3.0)  
- SAMtools v1.13 (GCC-10.3.0)  

---

### SemiBin2 (v2.2.1)  
Repository: [SemiBin2](https://github.com/BigDataBiology/SemiBin)

