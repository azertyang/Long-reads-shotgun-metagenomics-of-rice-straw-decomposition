## Long reads shotgun metagenomics of rice straw decomposition - Project overview

This project evaluates long-read shotgun metagenomic assemblies generated from PacBio HiFi sequencing of rice straw decomposition samples.

The main objective was to compare different assembly strategies and contig-level binning approaches in order to assess their impact on metagenome-assembled genome (MAG) reconstruction quality.

Specifically, the project benchmarks:

- Assembly tools: **hifiasm-meta** and **metaFlye**
- Binning approaches: **LorBin** and **SemiBin2**
- Pipeline comparison: **MetaWGS** and **HiFi-MAG**
- Quality assessment using **MAGFlow** and **BIgMAG**

Performance was evaluated based on:
- Genome completeness
- Contamination
- Overall MAG quality

---

## Main Findings (Summary)

- Assembly strategy showed minor effects on downstream binning performance, but no statistically significant differences were detected.
- The choice of binner influenced genome completeness and contamination metrics.
- Overall MAG quality was primarily determined by the binning approach rather than the assembler used.

(Full quantitative results are available in the `Binning/` and `Assembly/` directories.)

```
project/
│
├── Assembly/
│   ├── fastqc/
│   ├── hifiasm-meta/
│   │   ├── assembly_metrics/
│   │   ├── assembly_metrics_primary/
│   │   └── multiqc_report/
│   │
│   ├── metaflye/
│   │   ├── assembly_metrics/
│   │   ├── assembly_metrics_primary/
│   │   └── multiqc_report/
│   │
│   ├── comparison_plots/
│   └── software_versions/
│
├── Binning/
│   ├── metagWGS/
│   ├── samples/
│   │   ├── new_no_treatment/
│   │   ├── new_treatment/
│   │   ├── old_no_treatment/
│   │   └── old_treatment/
│
├── scripts/
│   ├── R/
│   └── bash/
│
└── README.md
```

### Assembly

Contains quality control, assembly outputs, and assembly comparison results for hifiasm-meta and metaFlye.

- `fastqc/` – Quality control reports for raw reads  
- `hifiasm-meta/` – Assembly outputs and metrics  
- `metaflye/` – Assembly outputs and metrics  
- `comparison_plots/` – Assembly comparison visualizations  
- `software_versions/` – Software versions used for MetaWGS  

### Binning

Contains binning results and quality assessment for different pipelines and sample types.

- `metagWGS/` – Outputs and plots generated by the MetaWGS pipeline  
- `samples/` – Binning results grouped by sample type:
  - `new_no_treatment/`
  - `new_treatment/`
  - `old_no_treatment/`
  - `old_treatment/`

### Scripts

Contains all analysis scripts used in this project.

- `R/` – Statistical analyses and plotting scripts  
- `bash/` – Workflow and execution scripts  

---

## Dataset Information

All analyses were performed on PacBio HiFi long-read shotgun metagenomic datasets obtained from rice straw decomposition samples.

## Tools and Software

### MetaWGS Pipeline (v2.5.0)  
Repository: [MetaWGS](https://forge.inrae.fr/genotoul-bioinfo/metagwgs)

- Nextflow v22.04.0  
- Python v3.10.8  
- FastQC v0.12.1  
- Hifiasm v0.13-r308  
- Quast v5.3.0  
- Minimap2 v2.24-r1122  
- Samtools v1.15.1  
- Concoct v1.1.0  
- MetaBAT2 v2.18  
- MaxBin v2.2.7  
- Binette v1.1.2  
- dRep v3.5.0  
- GTDB-Tk v2.4.0  
- tRNAscan-SE v2.0.11  
- Barrnap v0.9  
- Prodigal v2.6.3  

---

### LorBin (v0.1.0)  
Repository: [LorBin](https://github.com/LorMeBioAI/LorBin)

- Anaconda3 v2022.05  
- Minimap2 v2.20 (GCCcore-10.3.0)  
- SAMtools v1.13 (GCC-10.3.0)  

---

### SemiBin2 (v2.2.1)  
Repository: [SemiBin2](https://github.com/BigDataBiology/SemiBin)

---

### MAGFlow v1.1.0dev 
Repository: [MAGFlow](https://github.com/jeffe107/MAGFlow/tree/main)

